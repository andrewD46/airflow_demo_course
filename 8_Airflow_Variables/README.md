<h1 align="center">Variables</h1>

<br>

### Variables
Возможность передачи/приема информации через **XCom** имеется у каждого экземпляра задачи. 
**XCom** предназначен для взаимодействия внутри одного **DAG’а**, в то время как **Переменные** являются 
глобальными, предназначены для общей конфигурации и существуют только во время выполнения (runtime).

Например, некоторые задачи требуют определенные параметры конфигурации, 
например, **KubernetesPodOperator**. Вместо ручного создания значений параметров, 
можно просто определить переменную в **Variables** через **JSON**.

Итак, **Переменные** полезны для хранения и извлечения данных во время выполнения 
и позволяют избежать ручного задания значений и повторений кода в **DAG`ах**.

### Как создавать переменные

Переменные представляются также, как и **XCom**, в виде пары ключ-значение, а устанавливаются либо через пользовательский интерфейс, либо через командую строку.

Через пользовательский интерфейс переменные создаются через вкладку **Admin->Variables**. Можно также их задавать через командую строку. Например, установка (и создание, если переменной с таким ключом нет) переменной осуществляется через ключ **set**:

`airflow variables set my_key "1"`

Теперь мы можем экспортировать эту переменную в файл **JSON**:

`airflow variables export vars.json`

Импорт из файла, очевидно, осуществляется через команду `import`.

### Как использовать переменные в коде

Достать переменные в самом коде можно через класс `Variable` или через шаблоны **Jinjа**. Например:

```Python
from airflow.models import Variable


def result(ti):
    my_var = Variable.get("my_key")
```

Тип получаемого значения является **str**. Чтобы изменить его (если у вас не строка), установите параметр `deserialize_json=True`, который распарсит возвращаемое значение.


Через шаблоны **Jinjа** переменные также просто достаются:

```Python
bash_task = BashOperator(
    task_id="bash_task",
    bash_command="echo my_key = {{ var.value.my_key }}"
)
```



